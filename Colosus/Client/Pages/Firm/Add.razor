@page "/Firm/Add"
@using Colosus.Client.Blazor.Services.Firm
@using Colosus.Entity.Concretes
@using Colosus.Entity.Concretes.DatabaseModel
@using Colosus.Entity.Concretes.RequestModel
@inject IFirmService firmService
@inject NavigationManager navigationManager

<div class="center-container">
    <div class="container-header">
        <h3>Firma Oluştur</h3>
    </div>
    <Colosus.Client.Blazor.Components.Entry Placeholder="Firma Adı" @bind-Text="firm.Name"></Colosus.Client.Blazor.Components.Entry>
    <Colosus.Client.Blazor.Components.Button Text="Oluştur" OnClick="async()=> await AddFirm()"></Colosus.Client.Blazor.Components.Button>
</div>

@code {
    Colosus.Entity.Concretes.DatabaseModel.Firm firm = new();

    public async Task AddFirm()
    {
        RequestResult res = await firmService.AddFirm(firm);

        if (res == null)
        {
            await AddFirm();
            return;
        }

        AppState.AddMessage(res.Description);
        navigationManager.NavigateTo("/Firm/Index");
    }
}
