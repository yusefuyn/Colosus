@using Colosus.Client.Blazor.Services.Customer
@using Colosus.Entity.Concretes.CreateModel
@using Colosus.Entity.Concretes.DatabaseModel
@inject ICustomerService customerService

<Colosus.Client.Blazor.Components.Entry Placeholder="Miktar"
                                 TextChanged="(e)=>debt.Price = Convert.ToDecimal(e.ToString())"
                                 Type="Components.Entry.EntryTypeEnum.Number"></Colosus.Client.Blazor.Components.Entry>
<Colosus.Client.Blazor.Components.Entry @bind-Text="debt.Note"
                                 Placeholder="Note"
                                 Type="Components.Entry.EntryTypeEnum.Text"></Colosus.Client.Blazor.Components.Entry>
<Colosus.Client.Blazor.Components.Entry Placeholder="Ödeme Tarihi"
                                 TextChanged="(e)=>debt.PayDate = DateTime.Parse(e)"
                                 Type="Components.Entry.EntryTypeEnum.Date"></Colosus.Client.Blazor.Components.Entry>
<Colosus.Client.Blazor.Components.Button Text="Ekle"
                                  OnClick="async ()=>await AddDeb()"></Colosus.Client.Blazor.Components.Button>
@code {

    [Parameter] public DebitType Type { get; set; }
    [Parameter] public string CustomerPublicKey { get; set; }

    private DebtCreateModel debt = new();

    [Parameter] public Task CloseAction { get; set; }
    public async Task AddDeb()
    {
        debt.CustomerPublicKey = this.CustomerPublicKey;
        debt.Type = Type;
        await customerService.AddDebt(debt);
        if (CloseAction != null)
            CloseAction.Start();
    }

}
